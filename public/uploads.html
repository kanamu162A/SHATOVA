<!-- Sidebar -->
<div class="sidebar">
  <div>
    <h2>Shatova</h2>
    <a href="#" onclick="showSection('dashboard')">Dashboard</a>
    <a href="#" onclick="showSection('chat')">Let's Chat</a>
    <a href="#" onclick="showSection('uploads')">Uploads</a>
    <a href="#" onclick="showSection('history')">History</a>
  </div>
  <div class="logout" onclick="logout()">Log out</div>
</div>

<!-- Main Content -->
<div class="main">

  <!-- Dashboard Section -->
  <div id="dashboard" class="section">
    <h1>Welcome to the Dashboard</h1>
    <!-- Add more dashboard content here -->
  </div>

  <!-- Chat Section -->
  <div id="chat" class="section" style="display:none;">
    <h1>Chat with others</h1>
    <!-- Chat content goes here -->
  </div>

  <!-- Upload Section -->
  <div id="uploads" class="section" style="display:none;">
    <h1>Upload a Product</h1>
    <form id="uploadForm">
      <label for="productName">Product Name</label>
      <input type="text" id="productName" required />

      <label for="category">Category</label>
      <select id="category" required>
        <option value="">Select Category</option>
        <option value="clothing">Clothing</option>
        <option value="snacks">Snacks</option>
        <option value="food">Food</option>
        <option value="vegetables">Vegetables</option>
        <option value="furniture">Furniture</option>
      </select>

      <label for="price">Price (â‚¦)</label>
      <input type="number" id="price" required />

      <label for="description">Description</label>
      <textarea id="description" rows="4" placeholder="Enter description..."></textarea>

      <label for="image">Image Upload</label>
      <input type="file" id="image" accept="image/*" required />

      <button type="submit">Upload</button>
    </form>
  </div>

  <!-- History Section -->
  <div id="history" class="section" style="display:none;">
    <h1>Transaction History</h1>
    <!-- History content -->
  </div>

</div>

<script>
  const token = localStorage.getItem("shatova_token");
  if (!token) {
    window.location.href = "/login.html";
  }

  function logout() {
    localStorage.removeItem("shatova_token");
    window.location.href = "/login.html";
  }

  function showSection(sectionId) {
    const sections = document.querySelectorAll(".section");
    sections.forEach(section => section.style.display = "none");

    const target = document.getElementById(sectionId);
    if (target) target.style.display = "block";
  }

  document.getElementById("uploadForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const productName = document.getElementById("productName").value;
    const category = document.getElementById("category").value;
    const price = document.getElementById("price").value;
    const description = document.getElementById("description").value;
    const image = document.getElementById("image").files[0];

    if (!productName || !category || !price || !image) {
      return alert("Please fill in all required fields.");
    }

    const formData = new FormData();
    formData.append("product_name", productName);
    formData.append("category", category);
    formData.append("price", price);
    formData.append("description", description);
    formData.append("image", image);
    formData.append("user_id", "1"); // Replace with real user_id

    try {
      const response = await fetch("https://shatova.onrender.com/api/shatova/V1/upload", {
        method: "POST",
        body: formData
      });

      const result = await response.json();
      if (response.ok) {
        alert("Product uploaded successfully!");
        document.getElementById("uploadForm").reset();
      } else {
        alert("Upload failed: " + result.error);
      }
    } catch (err) {
      console.error(err);
      alert("Something went wrong!");
    }
  });
</script>
